<div>
<%= render "shared/header_links" %>
</div>

<ul>
    <li>
        Creator: <%= @event.organizer %>
        <div>
          Title: <%= @event.title %>
        </div>
        <div>
          Start date: <%= @event.start_date %>
        </div>
        <div>
          Start time: <%= @event.start_time.to_fs(:time) %>
        </div>
        <div>
          Ent date: <%= @event.end_date %>
        </div>
        <div>
          End time: <%= @event.end_time.to_fs(:time) %>
        </div>
        <div>
          Description: <%= @event.description %>
        </div>
        <% if current_user.username == @event.organizer %>
          <div>
            This event is <%= @event.visibility %>. To change its visibility, click <%= link_to "here", edit_event_url(@event) %>
          </div>
          <div>
            <p>Invite users:<p>
            <%= form_with model: Invitation.new, url: event_invitations_path(@event) do |f| %>
              <%= f.collection_check_boxes(:invitee_ids, User.order(:username).reject { |n| n == current_user}, :id, :username) do |b| %>

                <li style="list-style-type: none;">
                  <%= b.check_box %>
                  <%= b.label  %>
                </li>
                <% end %><br />
                <%= f.submit "Send Invitations"%>
            <% end %><br>
          </div>
        <% end %>
    </li>
</ul>

<div>
  attendees:
  <ul>
      <% @event.attendees.each do |a| %>
        <li> <%= a.username %> </li>
      <% end %>
  </ul>
</div>

  <% if current_user && @event.creator_id == current_user.id  %>
    <%= button_to "Edit event", edit_event_url(@event), method: :get %><br />

    <%= button_to "Cancel event", event_url(@event), method: :delete, data: {turbo_confirm: "Are you sure?"} %><br />
  <% end %>

  <% if @event.start_date >= Date.current %>
    <% if @event.attendees.include?(current_user) %>
      <%= button_to "Cancel my attendance", event_attendance_url(attendance: {attended_event_id: @event, attendee_id: current_user} ), method: :delete %><br />
    <% else %>
      <%= button_to "Attend Event", event_attendances_url(attendance: {attended_event_id: @event, attendee_id: current_user} ) %><br />
    <% end %>
  <% end %>
